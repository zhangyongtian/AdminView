{"version":3,"sources":["webpack:///./src/components/Photo/photoupdate.vue?5508","webpack:///src/components/Photo/photoupdate.vue","webpack:///./src/components/Photo/photoupdate.vue?dcdc","webpack:///./src/components/Photo/photoupdate.vue","webpack:///./src/util/requestnetwork/adminrequest.js"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","dialogVisible","on","$event","showopend","ref","staticStyle","preimg","slot","_v","commitphoto","path","photo","imgurl","showdrag","staticRenderFns","component","savephoto","data","request","method","url","selectPagePhoto","deletePhotoById","getPhotoById","updatePhotoById"],"mappings":"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","file":"js/chunk-14cc074c.d41c86b4.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"photoupdate\"},[_c('el-dialog',{attrs:{\"title\":\"提示\",\"visible\":_vm.dialogVisible,\"width\":\"30%\"},on:{\"update:visible\":function($event){_vm.dialogVisible=$event},\"opened\":_vm.showopend}},[_c('div',[_c('img',{ref:\"tarimg\",staticStyle:{\"display\":\"block\",\"max-width\":\"100%\"},attrs:{\"src\":_vm.preimg,\"alt\":\"\"}})]),_c('span',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.dialogVisible = false}}},[_vm._v(\"取 消\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.commitphoto}},[_vm._v(\"确 定\")])],1)]),_c('el-card',{staticClass:\"box-card\"},[_c('div',{staticClass:\"clearfix\",attrs:{\"slot\":\"header\"},slot:\"header\"},[_c('el-breadcrumb',{attrs:{\"separator-class\":\"el-icon-arrow-right\"}},[_c('el-breadcrumb-item',{attrs:{\"to\":{ path: '/admin/photoadmin' }}},[_vm._v(\"超级管理员界面\")]),_c('el-breadcrumb-item',[_vm._v(\"图片修改\")])],1)],1),_c('div',[_c('el-card',{staticClass:\"box-card\"},[_c('img',{attrs:{\"src\":_vm.photo.imgurl,\"alt\":\"\"}})]),_c('input',{ref:\"file\",attrs:{\"type\":\"file\",\"hidden\":\"hidden\",\"id\":\"file\"},on:{\"change\":_vm.showdrag}}),_c('el-button',{staticStyle:{\"margin-top\":\"10px\"},attrs:{\"type\":\"primary\"}},[_c('label',{attrs:{\"for\":\"file\"}},[_vm._v(\"点击修改\")])])],1)])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n\t<div class=\"photoupdate\">\r\n\t\t<el-dialog\r\n\t\ttitle=\"提示\"\r\n\t\t:visible.sync=\"dialogVisible\"\r\n\t\twidth=\"30%\"\r\n\t\t@opened=\"showopend\"\r\n\t\t>\r\n\t\t\t<div>\r\n\t\t\t\t<img :src=\"preimg\" alt=\"\" style=\"display: block;max-width: 100%;\" ref=\"tarimg\">\r\n\t\t\t</div>\r\n\t\t\t<span slot=\"footer\" class=\"dialog-footer\">\r\n\t\t\t<el-button @click=\"dialogVisible = false\">取 消</el-button>\r\n\t\t\t<el-button type=\"primary\" @click=\"commitphoto\">确 定</el-button>\r\n\t\t\t</span>\r\n\t\t</el-dialog>\r\n\t\t\r\n\t\t<el-card class=\"box-card\">\r\n\t\t\t<div slot=\"header\" class=\"clearfix\">\r\n\t\t\t\t<el-breadcrumb separator-class=\"el-icon-arrow-right\">\r\n\t\t\t\t\t<el-breadcrumb-item :to=\"{ path: '/admin/photoadmin' }\">超级管理员界面</el-breadcrumb-item>\r\n\t\t\t\t\t<el-breadcrumb-item>图片修改</el-breadcrumb-item>\r\n\t\t\t\t</el-breadcrumb>\r\n\t\t\t</div>\r\n\t\t\t<div>\r\n\t\t\t\t<el-card class=\"box-card\">\r\n\t\t\t\t\t<img :src=\"photo.imgurl\" alt=\"\">\r\n\t\t\t\t</el-card>\r\n\t\t\t\t<input type=\"file\" hidden=\"hidden\" id=\"file\" @change=\"showdrag\" ref=\"file\">\r\n\t\t\t\t<el-button type=\"primary\" style=\"margin-top: 10px;\"><label for=\"file\">点击修改</label></el-button>\r\n\t\t\t</div>\r\n\t\t</el-card>\r\n\t</div>\n</template>\n\n<script>\r\n\timport 'cropperjs/dist/cropper.css';\r\n\timport {uploadFileRequest} from '@/util/requestnetwork/uploadFileRequest'\r\n\timport {updatePhotoById} from '@/util/requestnetwork/adminrequest'\r\n\t\r\n\timport {getPhotoById} from \"@/util/requestnetwork/adminrequest\"\r\n\t\r\n\timport Cropper from 'cropperjs';\r\n\t\r\n\t\t// 使用oss\r\n\timport {alibabafilerequestimp} from '@/util/requestnetwork/ossRequestFileToAli'\r\n\timport {filegetprotiy} from '@/util/requestnetwork/ossRequestFileToAli'\r\n\texport default{\r\n\t\tname:\"photoupdate\",\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tdialogVisible: false,\r\n\t\t\t\tpreimg:\"\",\r\n\t\t\t\tcropper:null,\r\n\t\t\t\tphoto:{}\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tshowdrag() {\r\n\t\t\t\tthis.dialogVisible=true;\r\n\t\t\t\tconst file=this.$refs.file;\r\n\t\t\t\tthis.preimg=window.URL.createObjectURL(file.files[0]);\r\n\t\t\t\tthis.$refs.file.value=''\r\n\t\t\t},\r\n\t\t\tshowopend(){\r\n\t\t\t\tif(this.cropper!=null){\r\n\t\t\t\t\tthis.cropper.replace(this.preimg);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tconst imgg=this.$refs.tarimg;\r\n\t\t\t\tthis.cropper=new Cropper(imgg,{\r\n\t\t\t\t\taspectRatio: 2,\r\n\t\t\t\t\tviewMode:1,\r\n\t\t\t\t\tdragMode: \"none\",\r\n\t\t\t\t\tcropBoxResizable:true,\r\n\t\t\t\t\tcropBoxMovable:true\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tcommitphoto(){\r\n\t\t\t\t// this.dialogVisible=false;\r\n\r\n\t\t\tthis.cropper.getCroppedCanvas().toBlob((file) => {\r\n\t\t\t\t\r\n\t\t\tconst fd=new FormData();\r\n\t\t\t// //这里改成oss的\r\n\t\t\tlet url=\"\";\r\n\t\t\t let policy={};\r\n\t\t\t function getUUID () {\r\n\t\t\t   return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, c => {\r\n\t\t\t     return (c === 'x' ? (Math.random() * 16 | 0) : ('r&0x3' | '0x8')).toString(16)\r\n\t\t\t   })\r\n\t\t\t }\r\n\t\t\t\t\r\n\t\t\t\t\r\n\r\n// 这里上传的时候因为没有名字,所以手动的添加文件的名字\r\n\r\n\t\t\tlet filename=Math.random()+\".png\";\r\n\t\t\t\r\n\t\t\tfilegetprotiy().then(response=>{\r\n\t\t\t\t\t\t\t\tpolicy.policy = response.data.policy;\r\n\t\t\t\t\t\t\t\tpolicy.signature = response.data.signature;\r\n\t\t\t\t\t\t\t\tpolicy.ossaccessKeyId = response.data.accessid;\r\n\t\t\t\t\t\t\t\tpolicy.key = response.data.dir +getUUID()+'_${filename}';\r\n\t\t\t\t\t\t\t\tpolicy.dir = response.data.dir;\r\n\t\t\t\t\t\t\t\tpolicy.host = response.data.host;\r\n\t\t\t\t\t\t\t\t// _self.dataObj.policy = response.data.policy;\r\n\t\t\t\t\t\t\t\t// _self.dataObj.signature = response.data.signature;\r\n\t\t\t\t\t\t\t\t// _self.dataObj.ossaccessKeyId = response.data.accessid;\r\n\t\t\t\t\t\t\t\t// _self.dataObj.key = response.data.dir +this.getUUID()+'_${filename}';\r\n\t\t\t\t\t\t\t\t// _self.dataObj.dir = response.data.dir;\r\n\t\t\t\t\t\t\t\t// _self.dataObj.host = response.data.host;\r\n\t\t\t\t\t\t\t\tfd.append(\"policy\",policy.policy);\r\n\t\t\t\t\t\t\t\tfd.append(\"signature\",policy.signature);\r\n\t\t\t\t\t\t\t\tfd.append(\"key\",policy.key);\r\n\t\t\t\t\t\t\t\tfd.append(\"ossaccessKeyId\",policy.ossaccessKeyId);\r\n\t\t\t\t\t\t\t\tfd.append(\"dir\",policy.dir);\r\n\t\t\t\t\t\t\t\tfd.append(\"host\",policy.host);\r\n\t\t\t\t\t\t\t\tfd.append(\"file\",file,filename);\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t  alibabafilerequestimp(fd).then(res=>{\r\n\t\t\t\t\t\t\t\t\turl=policy.host + '/' + policy.key.replace(\"${filename}\",filename);\r\n\t\t\t\t\t\t\t\t\t\t\t\tthis.photo.imgurl=url;\r\n\t\t\t\t\t\t\t\t\t\t\t\tlet img={};\r\n\t\t\t\t\t\t\t\t\t\t\t\timg.imgurl=this.photo.imgurl;\r\n\t\t\t\t\t\t\t\t\t\t\t\timg.id=this.photo.id;\r\n\t\t\t\t\t\t\t\t\t\t\t\tupdatePhotoById(JSON.stringify(img)).then(res=>{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis.dialogVisible=false;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t this.$message({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tmessage: '恭喜你，修改成功',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttype: 'success'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t\t}).catch(error=>{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\tthis.dialogVisible=false;\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\r\n\r\n// \t\t\tuploadFileRequest(formData).then(res=>{\r\n// \r\n// \t\t\tlet resultimg=res.data.data;\r\n// \t\t\tthis.photo.imgurl=resultimg;\r\n// \t\t\tlet img={};\r\n// \t\t\timg.imgurl=this.photo.imgurl;\r\n// \t\t\timg.id=this.photo.id;\r\n// \t\t\tupdatePhotoById(JSON.stringify(img)).then(res=>{\r\n// \t\t\t\tthis.dialogVisible=false;\r\n// \t\t\t\t this.$message({\r\n// \t\t\t\tmessage: '恭喜你，修改成功',\r\n// \t\t\t\ttype: 'success'\r\n// \t\t\t\t});\r\n// \t\t\t}).catch(error=>{\r\n// \t\t\t\t\r\n// \t\t\t})\r\n// \t\t\t}).catch(error=>{\r\n// \r\n// \t\t\t})\r\n\t\t\t\r\n\t\t\t//这里是截止的地方\r\n\t\t\t})}\r\n\t\t\t},\r\n\t\t\tcreated(){\r\n\t\t\t\tlet photo={};\r\n\t\t\t\tphoto.id=this.$route.params[\"photoid\"];\r\n\t\t\t\tgetPhotoById(JSON.stringify(photo)).then(res=>{\r\n\t\t\t\t\tthis.photo=res.data.data;\r\n\t\t\t\t}).catch(error=>{\r\n\t\t\t\t\t\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\n</script>\n\n<style>\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./photoupdate.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./photoupdate.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./photoupdate.vue?vue&type=template&id=0f38a134&\"\nimport script from \"./photoupdate.vue?vue&type=script&lang=js&\"\nexport * from \"./photoupdate.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import {request} from '@/util/requestnetwork/request'\r\nconst savephoto=data=>{\r\n\treturn request({\r\n\t\tmethod:\"POST\",\r\n\t\turl:\"/rememberme/admin/savephoto\",\r\n\t\tdata\r\n\t})\r\n}\r\n\r\nconst selectPagePhoto=data=>{\r\n\treturn request({\r\n\t\tmethod:\"POST\",\r\n\t\turl:\"/rememberme/admin/selectPagePhoto\",\r\n\t\tdata\r\n\t})\r\n}\r\n\r\nconst deletePhotoById=data=>{\r\n\treturn request({\r\n\t\tmethod:\"POST\",\r\n\t\turl:\"/rememberme/admin/deletePhotoById\",\r\n\t\tdata\r\n\t})\r\n}\r\n\r\nconst getPhotoById=data=>{\r\n\treturn request({\r\n\t\tmethod:\"POST\",\r\n\t\turl:\"/rememberme/admin/getPhotoById\",\r\n\t\tdata\r\n\t})\r\n}\r\n\r\nconst updatePhotoById=data=>{\r\n\treturn request({\r\n\t\tmethod:\"POST\",\r\n\t\turl:\"/rememberme/admin/updatePhotoById\",\r\n\t\tdata\r\n\t})\r\n}\r\n\r\nexport {savephoto,selectPagePhoto,deletePhotoById,getPhotoById,updatePhotoById}\r\n"],"sourceRoot":""}