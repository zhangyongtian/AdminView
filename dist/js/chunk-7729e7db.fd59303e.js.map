{"version":3,"sources":["webpack:///./src/components/userdetail/userdetail.vue?eb41","webpack:///./node_modules/core-js/modules/es.function.name.js","webpack:///./src/components/userdetail/userdetail.vue?446c","webpack:///./src/util/requestnetwork/userrequest.js","webpack:///src/components/userdetail/userdetail.vue","webpack:///./src/components/userdetail/userdetail.vue?e76c","webpack:///./src/components/userdetail/userdetail.vue"],"names":["DESCRIPTORS","defineProperty","f","FunctionPrototype","Function","prototype","FunctionPrototypeToString","toString","nameRE","NAME","configurable","get","call","this","match","error","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","slot","path","_v","dialogVisible","on","$event","dialogopen","ref","staticStyle","preimage","headimgcommit","user","userimage","filechange","ruleForm","rules","model","value","callback","$$v","$set","expression","submitForm","resetForm","staticRenderFns","userrequest","data","request","method","url","component"],"mappings":"yIAAA,W,qBCAA,IAAIA,EAAc,EAAQ,QACtBC,EAAiB,EAAQ,QAAuCC,EAEhEC,EAAoBC,SAASC,UAC7BC,EAA4BH,EAAkBI,SAC9CC,EAAS,wBACTC,EAAO,OAIPT,KAAiBS,KAAQN,IAC3BF,EAAeE,EAAmBM,EAAM,CACtCC,cAAc,EACdC,IAAK,WACH,IACE,OAAOL,EAA0BM,KAAKC,MAAMC,MAAMN,GAAQ,GAC1D,MAAOO,GACP,MAAO,Q,yCCjBf,IAAIC,EAAS,WAAa,IAAIC,EAAIJ,KAASK,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,cAAc,CAACF,EAAG,UAAU,CAACE,YAAY,YAAY,CAACF,EAAG,MAAM,CAACE,YAAY,WAAWC,MAAM,CAAC,KAAO,UAAUC,KAAK,UAAU,CAACJ,EAAG,gBAAgB,CAACG,MAAM,CAAC,kBAAkB,wBAAwB,CAACH,EAAG,qBAAqB,CAACG,MAAM,CAAC,GAAK,CAAEE,KAAM,YAAa,CAACR,EAAIS,GAAG,QAAQN,EAAG,qBAAqB,CAACH,EAAIS,GAAG,WAAW,IAAI,GAAGN,EAAG,YAAY,CAACG,MAAM,CAAC,MAAQ,OAAO,QAAUN,EAAIU,cAAc,MAAQ,OAAOC,GAAG,CAAC,iBAAiB,SAASC,GAAQZ,EAAIU,cAAcE,GAAQ,OAASZ,EAAIa,aAAa,CAACV,EAAG,MAAM,CAACA,EAAG,MAAM,CAACW,IAAI,YAAYC,YAAY,CAAC,QAAU,QAAQ,YAAY,QAAQT,MAAM,CAAC,IAAMN,EAAIgB,SAAS,IAAM,QAAQb,EAAG,OAAO,CAACE,YAAY,gBAAgBC,MAAM,CAAC,KAAO,UAAUC,KAAK,UAAU,CAACJ,EAAG,YAAY,CAACQ,GAAG,CAAC,MAAQ,SAASC,GAAQZ,EAAIU,eAAgB,KAAS,CAACV,EAAIS,GAAG,SAASN,EAAG,YAAY,CAACG,MAAM,CAAC,KAAO,WAAWK,GAAG,CAAC,MAAQX,EAAIiB,gBAAgB,CAACjB,EAAIS,GAAG,UAAU,KAAKN,EAAG,MAAM,CAACE,YAAY,kBAAkB,CAACF,EAAG,MAAM,CAACG,MAAM,CAAC,IAAMN,EAAIkB,KAAKC,UAAU,IAAM,MAAMhB,EAAG,MAAM,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,IAAM,SAAS,CAACH,EAAG,SAAS,CAACH,EAAIS,GAAG,aAAa,OAAON,EAAG,QAAQ,CAACW,IAAI,WAAWR,MAAM,CAAC,KAAO,OAAO,OAAS,GAAG,GAAK,QAAQK,GAAG,CAAC,OAASX,EAAIoB,cAAcjB,EAAG,MAAM,CAACE,YAAY,mBAAmB,CAACF,EAAG,UAAU,CAACW,IAAI,WAAWT,YAAY,gBAAgBC,MAAM,CAAC,MAAQN,EAAIqB,SAAS,MAAQrB,EAAIsB,MAAM,cAAc,UAAU,CAACnB,EAAG,eAAe,CAACG,MAAM,CAAC,MAAQ,MAAM,KAAO,SAAS,CAACH,EAAG,WAAW,CAACoB,MAAM,CAACC,MAAOxB,EAAIqB,SAAa,KAAEI,SAAS,SAAUC,GAAM1B,EAAI2B,KAAK3B,EAAIqB,SAAU,OAAQK,IAAME,WAAW,oBAAoB,GAAGzB,EAAG,eAAe,CAACA,EAAG,YAAY,CAACG,MAAM,CAAC,KAAO,WAAWK,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOZ,EAAI6B,WAAW,eAAe,CAAC7B,EAAIS,GAAG,UAAUN,EAAG,YAAY,CAACQ,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOZ,EAAI8B,UAAU,eAAe,CAAC9B,EAAIS,GAAG,SAAS,IAAI,IAAI,IAAI,IAAI,IACz3DsB,EAAkB,G,kHCAhBC,EAAY,SAAAC,GACjB,OAAOC,eAAQ,CACdC,OAAO,OACPC,IAAI,0BACJH,U,iCCkDF,GACA,kBACA,KAFA,WAGI,MAAJ,CACM,SAAN,CACQ,KAAR,IAEM,MAAN,CACQ,KAAR,CACA,CAAU,UAAV,EAAU,QAAV,SAAU,QAAV,QACA,CAAU,IAAV,EAAU,IAAV,GAAU,QAAV,iBAAU,QAAV,UAGA,QACA,iBACA,cACA,cAGE,QAAF,CACI,WADJ,SACA,GAAM,IAAN,OACM,KAAN,+BACQ,IAAR,EAcU,OADA,QAAV,uBACA,EAZA,aACA,2BACA,uCACA,oBACA,YACA,aACA,sCACA,wBASI,UArBJ,SAqBA,GACM,KAAN,wBAEA,WAxBA,WAyBA,sBACA,0BACA,eACA,qDACA,0BAEA,WA/BA,WAiCA,GADA,mBACA,qBAIA,2BACA,yBACA,cACA,WACA,gBACA,oBACA,yBATA,sCAaA,cA/CA,WA+CA,WACA,sBAEA,mBAEA,KACA,KACA,aACA,0EACA,qDAGA,qDAEA,2BAEA,mCACA,uBACA,6BACA,iCACA,oCACA,iBACA,mBAOA,4BACA,kCACA,sBACA,4CACA,sBACA,wBACA,qBAEA,oCACA,4CACA,mBACA,kBACA,8BACA,8BAeA,QA3HA,WA4HA,iCACA,wCCpLmW,I,wBCQ/VI,EAAY,eACd,EACAtC,EACAgC,GACA,EACA,KACA,KACA,MAIa,aAAAM,E","file":"js/chunk-7729e7db.fd59303e.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./userdetail.vue?vue&type=style&index=0&lang=less&\"","var DESCRIPTORS = require('../internals/descriptors');\nvar defineProperty = require('../internals/object-define-property').f;\n\nvar FunctionPrototype = Function.prototype;\nvar FunctionPrototypeToString = FunctionPrototype.toString;\nvar nameRE = /^\\s*function ([^ (]*)/;\nvar NAME = 'name';\n\n// Function instances `.name` property\n// https://tc39.github.io/ecma262/#sec-function-instances-name\nif (DESCRIPTORS && !(NAME in FunctionPrototype)) {\n  defineProperty(FunctionPrototype, NAME, {\n    configurable: true,\n    get: function () {\n      try {\n        return FunctionPrototypeToString.call(this).match(nameRE)[1];\n      } catch (error) {\n        return '';\n      }\n    }\n  });\n}\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"userdetail\"},[_c('el-card',{staticClass:\"box-card\"},[_c('div',{staticClass:\"clearfix\",attrs:{\"slot\":\"header\"},slot:\"header\"},[_c('el-breadcrumb',{attrs:{\"separator-class\":\"el-icon-arrow-right\"}},[_c('el-breadcrumb-item',{attrs:{\"to\":{ path: '/admin' }}},[_vm._v(\"首页\")]),_c('el-breadcrumb-item',[_vm._v(\"用户详情\")])],1)],1),_c('el-dialog',{attrs:{\"title\":\"选择图片\",\"visible\":_vm.dialogVisible,\"width\":\"30%\"},on:{\"update:visible\":function($event){_vm.dialogVisible=$event},\"opened\":_vm.dialogopen}},[_c('div',[_c('img',{ref:\"targetimg\",staticStyle:{\"display\":\"block\",\"max-width\":\"100%\"},attrs:{\"src\":_vm.preimage,\"alt\":\"\"}})]),_c('span',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.dialogVisible = false}}},[_vm._v(\"取 消\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.headimgcommit}},[_vm._v(\"确 定\")])],1)]),_c('div',{staticClass:\"userdetail_img\"},[_c('img',{attrs:{\"src\":_vm.user.userimage,\"alt\":\"\"}}),_c('div',[_c('label',{attrs:{\"for\":\"file\"}},[_c('el-tag',[_vm._v(\"点击修改头像\")])],1)])]),_c('input',{ref:\"filefile\",attrs:{\"type\":\"file\",\"hidden\":\"\",\"id\":\"file\"},on:{\"change\":_vm.filechange}}),_c('div',{staticClass:\"userdetail_from\"},[_c('el-form',{ref:\"ruleForm\",staticClass:\"demo-ruleForm\",attrs:{\"model\":_vm.ruleForm,\"rules\":_vm.rules,\"label-width\":\"100px\"}},[_c('el-form-item',{attrs:{\"label\":\"用户名\",\"prop\":\"name\"}},[_c('el-input',{model:{value:(_vm.ruleForm.name),callback:function ($$v) {_vm.$set(_vm.ruleForm, \"name\", $$v)},expression:\"ruleForm.name\"}})],1),_c('el-form-item',[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.submitForm('ruleForm')}}},[_vm._v(\"立即修改\")]),_c('el-button',{on:{\"click\":function($event){return _vm.resetForm('ruleForm')}}},[_vm._v(\"重置\")])],1)],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import {request} from '@/util/requestnetwork/request'\r\nconst userrequest=data=>{\r\n\treturn request({\r\n\t\tmethod:\"POST\",\r\n\t\turl:\"/rememberme/userrequest\",\r\n\t\tdata\r\n\t})\r\n}\r\nexport {userrequest}\r\n","<template>\r\n\t<div class=\"userdetail\">\r\n\t\t<el-card class=\"box-card\">\r\n\t\t\t<div slot=\"header\" class=\"clearfix\">\r\n\t\t\t\t<el-breadcrumb separator-class=\"el-icon-arrow-right\">\r\n\t\t\t\t\t<el-breadcrumb-item :to=\"{ path: '/admin' }\">首页</el-breadcrumb-item>\r\n\t\t\t\t\t<el-breadcrumb-item>用户详情</el-breadcrumb-item>\r\n\t\t\t\t</el-breadcrumb>\r\n\t\t\t</div>\r\n\t\t\t<el-dialog\r\n\t\ttitle=\"选择图片\"\r\n\t\t:visible.sync=\"dialogVisible\"\r\n\t\twidth=\"30%\"\r\n\t\t@opened=\"dialogopen\"\r\n\t\t>\r\n\t\t<div>\r\n\t\t\t<img :src=\"preimage\" alt=\"\" style=\"display: block;max-width: 100%;\" ref=\"targetimg\">\r\n\t\t</div>\r\n\t\t<span slot=\"footer\" class=\"dialog-footer\">\r\n\t\t\t<el-button @click=\"dialogVisible = false\">取 消</el-button>\r\n\t\t\t<el-button type=\"primary\" @click=\"headimgcommit\">确 定</el-button>\r\n\t\t\t</span>\r\n\t\t\t</el-dialog>\r\n\t\t\t<div class=\"userdetail_img\">\r\n\t\t\t\t<img :src=\"user.userimage\" alt=\"\">\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<label for=\"file\"><el-tag >点击修改头像</el-tag></label>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<input type=\"file\" hidden id=\"file\" ref=\"filefile\" @change=\"filechange\" >\r\n\t\t\t<div class=\"userdetail_from\">\r\n\t\t\t\t\t<el-form :model=\"ruleForm\" :rules=\"rules\" ref=\"ruleForm\" label-width=\"100px\" class=\"demo-ruleForm\">\r\n\t\t\t\t\t\t<el-form-item label=\"用户名\" prop=\"name\">\r\n\t\t\t\t\t\t\t<el-input v-model=\"ruleForm.name\"></el-input>\r\n\t\t\t\t\t</el-form-item>\r\n\r\n\t\t\t\t\t<el-form-item>\r\n\t\t\t\t\t\t<el-button type=\"primary\" @click=\"submitForm('ruleForm')\">立即修改</el-button>\r\n\t\t\t\t\t<el-button @click=\"resetForm('ruleForm')\">重置</el-button>\r\n  </el-form-item>\r\n</el-form>\r\n\t\t\t</div>\r\n\t\t</el-card>\r\n\t</div>\n</template>\n\n<script>\r\n\timport 'cropperjs/dist/cropper.css';\r\n\timport {uploadFileRequest} from '@/util/requestnetwork/uploadFileRequest'\r\n\timport {userrequest} from '@/util/requestnetwork/userrequest'\r\n\t// 使用oss\r\n\timport {alibabafilerequestimp} from '@/util/requestnetwork/ossRequestFileToAli'\r\n\timport {filegetprotiy} from '@/util/requestnetwork/ossRequestFileToAli'\r\n\t\r\n\timport Cropper from 'cropperjs';\r\n\texport default{\r\n\t\tname:\"userdetail\",\r\n\t\tdata() {\r\n      return {\r\n        ruleForm: {\r\n          name: ''\r\n        },\r\n        rules: {\r\n          name: [\r\n            { required: true, message: '请输入用户名', trigger: 'blur' },\r\n            { min: 3, max: 15, message: '长度在 3 到 30 个字符', trigger: 'blur' }\r\n          ]\r\n        },\r\n\t\tuser:{},\r\n\t\tdialogVisible: false,\r\n\t\tcroppper:null,\r\n\t\tpreimage:\"\"\r\n      };\r\n    },\r\n    methods: {\r\n      submitForm(formName) {\r\n        this.$refs[formName].validate((valid) => {\r\n          if (valid) {\r\n            // 提交\r\n\t\t\tlet user=this.user;\r\n\t\t\tuser.username=this.ruleForm.name;\r\n\t\t\tuserrequest(JSON.stringify(user)).then(res=>{\r\n\t\t\t\tconsole.log(\"修改成功\");\r\n\t\t\t\tthis.$message({\r\n\t\t\t\tshowClose: true,\r\n\t\t\t\tmessage: '恭喜你，修改信息成功，用户重新登录就可以刷新用户信息了',\r\n\t\t\t\ttype: 'success'\r\n\t\t\t});\r\n\t\t\t})\r\n          } else {\r\n            console.log('error submit!!');\r\n            return false;\r\n          }\r\n        });\r\n      },\r\n      resetForm(formName) {\r\n        this.$refs[formName].resetFields();\r\n      },\r\n\t  filechange(){\r\n\t\t  this.dialogVisible=true;\r\n\t\t  const file= this.$refs.filefile;\r\n\t\t  console.log(file)\r\n\t\t  this.preimage=window.URL.createObjectURL(file.files[0]);\r\n\t\t  this.$refs.file.value=''\r\n\t  },\r\n\t  dialogopen(){\r\n\t\t  console.log(\"出来了\")\r\n\t\t  \tif(this.croppper!=null){\r\n\t\t  \t\tthis.croppper.replace(this.preimage);\r\n\t\t  \t\treturn;\r\n\t\t  \t}\r\n\t\t  \tconst image = this.$refs.targetimg;\r\n\t\t  \tthis.croppper= new Cropper(image, {\r\n\t\t  \taspectRatio: 1,\r\n\t\t  \tviewMode:1,\r\n\t\t  \tdragMode: \"none\",\r\n\t\t  \tcropBoxResizable:true,\r\n\t\t  \tcropBoxMovable:true\r\n\t\t  });\r\n\r\n\t\t  },\r\n\t\t  headimgcommit(){\r\n\t\t\t  this.dialogVisible=false;\r\n\t\t\t  // this.dialogVisible=false;\r\n\t\t\t  const fd=new FormData();\r\n\t\t\t  // //这里改成oss的\r\n\t\t\t  let url=\"\";\r\n\t\t\t   let policy={};\r\n\t\t\t   function getUUID () {\r\n\t\t\t     return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, c => {\r\n\t\t\t       return (c === 'x' ? (Math.random() * 16 | 0) : ('r&0x3' | '0x8')).toString(16)\r\n\t\t\t     })\r\n\t\t\t   }\r\n\t\t\t  this.croppper.getCroppedCanvas().toBlob((file) => {\r\n\t\t\t  \t// 这里上传的时候因为没有名字,所以手动的添加文件的名字\r\n\t\t\t  \tlet filename=Math.random()+\".png\";\r\n\t\t\t  \t\r\n\t\t\t\tfilegetprotiy().then(response=>{\r\n\t\t\t\t\t\t\t\t\tpolicy.policy = response.data.policy;\r\n\t\t\t\t\t\t\t\t\tpolicy.signature = response.data.signature;\r\n\t\t\t\t\t\t\t\t\tpolicy.ossaccessKeyId = response.data.accessid;\r\n\t\t\t\t\t\t\t\t\tpolicy.key = response.data.dir +getUUID()+'_${filename}';\r\n\t\t\t\t\t\t\t\t\tpolicy.dir = response.data.dir;\r\n\t\t\t\t\t\t\t\t\tpolicy.host = response.data.host;\r\n\t\t\t\t\t\t\t\t\t// _self.dataObj.policy = response.data.policy;\r\n\t\t\t\t\t\t\t\t\t// _self.dataObj.signature = response.data.signature;\r\n\t\t\t\t\t\t\t\t\t// _self.dataObj.ossaccessKeyId = response.data.accessid;\r\n\t\t\t\t\t\t\t\t\t// _self.dataObj.key = response.data.dir +this.getUUID()+'_${filename}';\r\n\t\t\t\t\t\t\t\t\t// _self.dataObj.dir = response.data.dir;\r\n\t\t\t\t\t\t\t\t\t// _self.dataObj.host = response.data.host;\r\n\t\t\t\t\t\t\t\t\tfd.append(\"policy\",policy.policy);\r\n\t\t\t\t\t\t\t\t\tfd.append(\"signature\",policy.signature);\r\n\t\t\t\t\t\t\t\t\tfd.append(\"key\",policy.key);\r\n\t\t\t\t\t\t\t\t\tfd.append(\"ossaccessKeyId\",policy.ossaccessKeyId);\r\n\t\t\t\t\t\t\t\t\tfd.append(\"dir\",policy.dir);\r\n\t\t\t\t\t\t\t\t\tfd.append(\"host\",policy.host);\r\n\t\t\t\t\t\t\t\t\tfd.append(\"file\",file,filename);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t  alibabafilerequestimp(fd).then(res=>{\r\n\t\t\t\t\t\t\t\t\t\turl=policy.host + '/' + policy.key.replace(\"${filename}\",filename);\r\n\t\t\t\t\t\t\t\t\t\tthis.user.userimage=url;\r\n\t\t\t\t\t\t\t\t\t\tconsole.log(\"非得\")\r\n\t\t\t\t\t\t\t\t\t\tconsole.log(this.user.userimage)\r\n\t\t\t\t\t\t\t\t\t\tthis.dialogVisible=false;\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t  \t// uploadFileRequest(formData).then(res=>{\r\n\t\t\t  \t\t// let resultimg=res.data.data;\r\n\t\t\t  \t\t// this.user.userimage=resultimg;\r\n\t\t\t  \t\t// this.dialogVisible=false;\r\n\t\t\t  \t// }).catch(error=>{\r\n\t\t\t  \t// \t\r\n\t\t\t  \t// })\r\n\t\t\t  \t})\r\n\t\t  }\r\n    },\r\n\tcreated(){\r\n\t\tthis.user=this.$store.state.user;\r\n\t\tthis.ruleForm.name=this.user.username;\r\n\t}\r\n\t}\n</script>\n\n<style lang=\"less\">\r\n\t.userdetail{\r\n\t\t.userdetail_img{\r\n\t\t\t\r\n\t\t}\r\n\t\t.userdetail_from{\r\n\t\t\tmargin-top: 10px;\r\n\t\t}\r\n\t}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./userdetail.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./userdetail.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./userdetail.vue?vue&type=template&id=279402de&\"\nimport script from \"./userdetail.vue?vue&type=script&lang=js&\"\nexport * from \"./userdetail.vue?vue&type=script&lang=js&\"\nimport style0 from \"./userdetail.vue?vue&type=style&index=0&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}