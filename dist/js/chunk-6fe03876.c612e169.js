(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6fe03876"],{"0834":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:"修改图片",visible:e.dialogVisible,width:"30%"},on:{"update:visible":function(t){e.dialogVisible=t},opened:e.dialogOpen}},[a("div",[a("img",{ref:"digimg",staticStyle:{display:"block","max-width":"100%"},attrs:{src:e.preimage,alt:""}})]),a("span",[e._v("这是一段信息")]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.commitimg}},[e._v("确 定")])],1)]),a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"文章标题",prop:"title"}},[a("el-input",{model:{value:e.ruleForm.title,callback:function(t){e.$set(e.ruleForm,"title",t)},expression:"ruleForm.title"}})],1),a("el-form-item",{attrs:{label:"首图一张图片"}},[a("div",{staticStyle:{"text-align":"center"}},[a("img",{staticStyle:{"max-width":"100%"},attrs:{src:e.ruleForm.headimg,alt:""}})]),a("input",{ref:"file",attrs:{type:"file",hidden:"hidden",id:"file1"},on:{change:e.filechange}}),a("label",{attrs:{for:"file1"}},[e._v("点击修改图片")])]),a("el-form-item",{attrs:{label:"分类",prop:"classfiyname"}},[a("el-select",{attrs:{multiple:"",placeholder:"请选择博客的标签"},model:{value:e.ruleForm.classfiyname,callback:function(t){e.$set(e.ruleForm,"classfiyname",t)},expression:"ruleForm.classfiyname"}},e._l(e.blogclassfiy,(function(e){return a("el-option",{key:e.classfiyname,attrs:{label:e.classfiyname,value:e.classfiyid}})})),1)],1),a("el-form-item",{attrs:{label:"标签",prop:"tagname"}},[a("el-select",{attrs:{multiple:"",placeholder:"请选择博客的标签"},model:{value:e.ruleForm.tagname,callback:function(t){e.$set(e.ruleForm,"tagname",t)},expression:"ruleForm.tagname"}},e._l(e.blogtags,(function(e){return a("el-option",{key:e.tagname,attrs:{label:e.tagname,value:e.tagid}})})),1)],1),a("el-form-item",{attrs:{label:"是否发布",prop:"isfabu"}},[a("el-switch",{model:{value:e.ruleForm.isfabu,callback:function(t){e.$set(e.ruleForm,"isfabu",t)},expression:"ruleForm.isfabu"}})],1),a("el-form-item",{attrs:{label:"简介",prop:"introduce"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.ruleForm.introduce,callback:function(t){e.$set(e.ruleForm,"introduce",t)},expression:"ruleForm.introduce"}})],1),a("el-form-item",{attrs:{label:"文章内容",prop:"content"}},[a("richeditt",{on:{richdietcontenchange:e.richcontetchange}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("修改")]),a("el-button",{on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("重置")])],1)],1)],1)},i=[],r=(a("d3b7"),a("ac1f"),a("25f0"),a("3ca3"),a("5319"),a("ddb0"),a("2b3d"),a("6107"),a("bab4")),o=a.n(r),l=a("dd01"),s=a("ab6b"),c=a("f88e"),u=a("a186"),d=(a("5d30"),a("0acc")),m=function(e){return Object(d["a"])({method:"POST",url:"/rememberme/getBlogbyId",data:e})},f=function(e){return Object(d["a"])({method:"POST",url:"/rememberme/updateblog",data:e})},p=(a("60fb"),a("53e3")),g={name:"publicizeaticlefrom",components:{upload:l["a"],richeditt:s["a"]},data:function(){return{dialogVisible:!1,croppper:null,preimage:"",blogtags:[],blogclassfiy:[],ruleForm:{title:"",classfiyname:"",tagname:"",isfabu:!1,type:[],introduce:"",content:"",headimg:""},rules:{title:[{required:!0,message:"请输入标题"},{min:3,max:30,message:"长度在 3 到 30 个字符"}],classfiyname:[{required:!0,message:"请选择分类",trigger:"change"}],tagname:[{required:!0,message:"标签",trigger:"change"}],type:[{type:"array",required:!0,message:"请至少选择一个活动性质",trigger:"change"}],introduce:[{required:!0,message:"输入文章的简介",trigger:"change"}],content:[{required:!0,message:"输入文章的内容",trigger:"change"}]}}},methods:{submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;var a={};a.userid=t.$store.state.user.id,a.title=t.ruleForm.title,a.headimg=t.ruleForm.headimg,a.classfiy=t.ruleForm.classfiyname,a.tag=t.ruleForm.tagname,a.isfabu=t.ruleForm.isfabu?1:0,a.introduce=t.ruleForm.introduce,a.content=t.ruleForm.content,a.id=t.$route.params.blogid,console.log(JSON.stringify(a)),f(JSON.stringify(a)).then((function(e){console.log(e),200==e.data.status&&t.$message({showClose:!0,message:"修改成功",type:"success"})})).catch((function(e){console.log("保存blog错误")}))}))},resetForm:function(e){this.$refs[e].resetFields()},richcontetchange:function(e){this.ruleForm.content=e},gethimg:function(e){this.ruleForm.headimg=e},filechange:function(){console.log("文件修改了"),this.dialogVisible=!0;var e=this.$refs.file;this.preimage=window.URL.createObjectURL(e.files[0]),this.$refs.file.value=""},dialogOpen:function(){if(console.log("出来了"),null==this.croppper){var e=this.$refs.digimg;this.croppper=new o.a(e,{aspectRatio:1,viewMode:1,dragMode:"none",cropBoxResizable:!0,cropBoxMovable:!0}),console.log("========="),console.log(cropper)}else this.croppper.replace(this.preimage)},commitimg:function(){var e=this,t=new FormData,a="",n={};function i(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){return("x"===e?16*Math.random()|0:8).toString(16)}))}this.croppper.getCroppedCanvas().toBlob((function(r){var o=Math.random()+".png";Object(p["b"])().then((function(l){n.policy=l.data.policy,n.signature=l.data.signature,n.ossaccessKeyId=l.data.accessid,n.key=l.data.dir+i()+"_${filename}",n.dir=l.data.dir,n.host=l.data.host,t.append("policy",n.policy),t.append("signature",n.signature),t.append("key",n.key),t.append("ossaccessKeyId",n.ossaccessKeyId),t.append("dir",n.dir),t.append("host",n.host),t.append("file",r,o),Object(p["a"])(t).then((function(t){a=n.host+"/"+n.key.replace("${filename}",o),e.ruleForm.headimg=a,e.dialogVisible=!1}))}))}))}},created:function(){var e=this;Object(c["a"])().then((function(t){e.blogtags=t.data.data})).catch((function(e){console.log("请求标签错误")})),Object(u["a"])().then((function(t){e.blogclassfiy=t.data.data})).catch((function(e){console.log("请求标签错误")}));var t={};t.id=this.$route.params.blogid,m(JSON.stringify(t)).then((function(t){var a=t.data.data;e.ruleForm.content=a.content,e.ruleForm.title=a.title,e.ruleForm.isfabu=a.isfabu,e.ruleForm.introduce=a.introduce,e.ruleForm.headimg=a.headpic})).catch((function(e){}))}},x=g,h=a("2877"),b=Object(h["a"])(x,n,i,!1,null,null,null);t["default"]=b.exports},"5d30":function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a("0acc"),i=function(e){return Object(n["a"])({method:"POST",url:"/rememberme/saveBlog",data:e})}},9970:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a("0acc"),i=function(e){return Object(n["a"])({method:"POST",url:"/rememberme/ossFileUpload",data:e})}},a186:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a("0acc"),i=function(e){return Object(n["a"])({method:"POST",url:"/rememberme/getAllBlogClassfiy",data:e})}},ab6b:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-tiptap",{attrs:{extensions:e.extensions},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}})],1)},i=[],r=(a("b0c0"),a("d3b7"),a("ac1f"),a("25f0"),a("5319"),a("4ccc")),o=(a("60fb"),a("9970")),l=a("53e3"),s={data:function(){return{extensions:[new r["e"],new r["E"],new r["w"],new r["m"],new r["b"],new r["r"],new r["A"],new r["L"],new r["t"],new r["p"]({uploadRequest:function(e){var t=new FormData,a="",n={};function i(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){return("x"===e?16*Math.random()|0:8).toString(16)}))}return Object(o["a"])().then((function(r){console.log("=========="),console.log(r.data),n.policy=r.data.policy,n.signature=r.data.signature,n.ossaccessKeyId=r.data.accessid,n.key=r.data.dir+i()+"_${filename}",n.dir=r.data.dir,n.host=r.data.host,t.append("policy",n.policy),t.append("signature",n.signature),t.append("key",n.key),t.append("ossaccessKeyId",n.ossaccessKeyId),t.append("dir",n.dir),t.append("host",n.host),t.append("file",e),console.log(n),Object(l["a"])(t).then((function(e){console.log("发客户的反馈")})),a=n.host+"/"+n.key.replace("${filename}",e.name);var o=a;return o}))}}),new r["d"],new r["a"],new r["u"],new r["c"],new r["v"],new r["I"],new r["J"],new r["F"],new r["q"],new r["s"],new r["o"],new r["l"],new r["K"],new r["n"],new r["C"],new r["B"],new r["D"],new r["j"],new r["G"],new r["H"],new r["x"],new r["y"],new r["k"],new r["z"],new r["i"],new r["h"]],content:"\n          <h1>开始吧</h1>\n        ",lang:""}},components:{"el-tiptap":r["f"]},watch:{content:function(){this.$emit("richdietcontenchange",this.content)}},methods:{getUUID:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){return("x"===e?16*Math.random()|0:8).toString(16)}))}}},c=s,u=a("2877"),d=Object(u["a"])(c,n,i,!1,null,null,null);t["a"]=d.exports},b0c0:function(e,t,a){var n=a("83ab"),i=a("9bf2").f,r=Function.prototype,o=r.toString,l=/^\s*function ([^ (]*)/,s="name";n&&!(s in r)&&i(r,s,{configurable:!0,get:function(){try{return o.call(this).match(l)[1]}catch(e){return""}}})},dd01:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-upload",{attrs:{action:"https://huabei5zhanh.oss-cn-huhehaote.aliyuncs.com",data:e.dataObj,"list-type":"picture-card","on-preview":e.handlePictureCardPreview,"on-remove":e.handleRemove,multiple:!1,"on-success":e.successUpload,"before-upload":e.beforeUpload,"file-list":e.fileList}},[a("i",{staticClass:"el-icon-plus"})]),a("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1)},i=[],r=(a("b0c0"),a("d3b7"),a("ac1f"),a("25f0"),a("5319"),a("9970")),o={data:function(){return{dialogImageUrl:"",dialogVisible:!1,dataObj:{policy:"",signature:"",key:"",ossaccessKeyId:"",dir:"",host:""}}},methods:{handleRemove:function(e,t){console.log(e,t)},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},successUpload:function(e,t,a){this.fileList.pop(),this.fileList.push({name:t.name,url:this.dataObj.host+"/"+this.dataObj.key.replace("${filename}",t.name)}),console.log("最后的文件地址是"+this.fileList[0].url),this.$emit("getheadimg",this.fileList[0].url)},beforeUpload:function(e){var t=this,a=this;return new Promise((function(e,n){Object(r["a"])().then((function(n){console.log("紫红色哥是"),console.log(n.data),a.dataObj.policy=n.data.policy,a.dataObj.signature=n.data.signature,a.dataObj.ossaccessKeyId=n.data.accessid,a.dataObj.key=n.data.dir+t.getUUID()+"_${filename}",a.dataObj.dir=n.data.dir,a.dataObj.host=n.data.host,e(!0)})).catch((function(e){n(!1)}))}))},getUUID:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){return("x"===e?16*Math.random()|0:8).toString(16)}))}},computed:{fileList:function(){return[]}}},l=o,s=a("2877"),c=Object(s["a"])(l,n,i,!1,null,null,null);t["a"]=c.exports},f88e:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a("0acc"),i=function(e){return Object(n["a"])({method:"POST",url:"/rememberme/getAllBlogTags",data:e})}}}]);
//# sourceMappingURL=chunk-6fe03876.c612e169.js.map