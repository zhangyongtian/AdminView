(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7729e7db"],{"13a2":function(e,t,r){},5322:function(e,t,r){"use strict";r("13a2")},b0c0:function(e,t,r){var i=r("83ab"),a=r("9bf2").f,s=Function.prototype,o=s.toString,n=/^\s*function ([^ (]*)/,l="name";i&&!(l in s)&&a(s,l,{configurable:!0,get:function(){try{return o.call(this).match(n)[1]}catch(e){return""}}})},d186:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"userdetail"},[r("el-card",{staticClass:"box-card"},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[r("el-breadcrumb-item",{attrs:{to:{path:"/admin"}}},[e._v("首页")]),r("el-breadcrumb-item",[e._v("用户详情")])],1)],1),r("el-dialog",{attrs:{title:"选择图片",visible:e.dialogVisible,width:"30%"},on:{"update:visible":function(t){e.dialogVisible=t},opened:e.dialogopen}},[r("div",[r("img",{ref:"targetimg",staticStyle:{display:"block","max-width":"100%"},attrs:{src:e.preimage,alt:""}})]),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.headimgcommit}},[e._v("确 定")])],1)]),r("div",{staticClass:"userdetail_img"},[r("img",{attrs:{src:e.user.userimage,alt:""}}),r("div",[r("label",{attrs:{for:"file"}},[r("el-tag",[e._v("点击修改头像")])],1)])]),r("input",{ref:"filefile",attrs:{type:"file",hidden:"",id:"file"},on:{change:e.filechange}}),r("div",{staticClass:"userdetail_from"},[r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"用户名",prop:"name"}},[r("el-input",{model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("立即修改")]),r("el-button",{on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("重置")])],1)],1)],1)],1)],1)},a=[],s=(r("b0c0"),r("d3b7"),r("ac1f"),r("25f0"),r("3ca3"),r("5319"),r("ddb0"),r("2b3d"),r("6107"),r("60fb"),r("0acc")),o=function(e){return Object(s["a"])({method:"POST",url:"/rememberme/userrequest",data:e})},n=r("53e3"),l=r("bab4"),c=r.n(l),u={name:"userdetail",data:function(){return{ruleForm:{name:""},rules:{name:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:15,message:"长度在 3 到 30 个字符",trigger:"blur"}]},user:{},dialogVisible:!1,croppper:null,preimage:""}},methods:{submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;var r=t.user;r.username=t.ruleForm.name,o(JSON.stringify(r)).then((function(e){console.log("修改成功"),t.$message({showClose:!0,message:"恭喜你，修改信息成功，用户重新登录就可以刷新用户信息了",type:"success"})}))}))},resetForm:function(e){this.$refs[e].resetFields()},filechange:function(){this.dialogVisible=!0;var e=this.$refs.filefile;console.log(e),this.preimage=window.URL.createObjectURL(e.files[0]),this.$refs.file.value=""},dialogopen:function(){if(console.log("出来了"),null==this.croppper){var e=this.$refs.targetimg;this.croppper=new c.a(e,{aspectRatio:1,viewMode:1,dragMode:"none",cropBoxResizable:!0,cropBoxMovable:!0})}else this.croppper.replace(this.preimage)},headimgcommit:function(){var e=this;this.dialogVisible=!1;var t=new FormData,r="",i={};function a(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){return("x"===e?16*Math.random()|0:8).toString(16)}))}this.croppper.getCroppedCanvas().toBlob((function(s){var o=Math.random()+".png";Object(n["b"])().then((function(l){i.policy=l.data.policy,i.signature=l.data.signature,i.ossaccessKeyId=l.data.accessid,i.key=l.data.dir+a()+"_${filename}",i.dir=l.data.dir,i.host=l.data.host,t.append("policy",i.policy),t.append("signature",i.signature),t.append("key",i.key),t.append("ossaccessKeyId",i.ossaccessKeyId),t.append("dir",i.dir),t.append("host",i.host),t.append("file",s,o),Object(n["a"])(t).then((function(t){r=i.host+"/"+i.key.replace("${filename}",o),e.user.userimage=r,console.log("非得"),console.log(e.user.userimage),e.dialogVisible=!1}))}))}))}},created:function(){this.user=this.$store.state.user,this.ruleForm.name=this.user.username}},d=u,m=(r("5322"),r("2877")),p=Object(m["a"])(d,i,a,!1,null,null,null);t["default"]=p.exports}}]);
//# sourceMappingURL=chunk-7729e7db.fd59303e.js.map