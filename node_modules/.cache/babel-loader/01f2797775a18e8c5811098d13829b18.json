{"remainingRequest":"D:\\biyesheji\\AdminView\\adminvue\\node_modules\\babel-loader\\lib\\index.js!D:\\biyesheji\\AdminView\\adminvue\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\biyesheji\\AdminView\\adminvue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\biyesheji\\AdminView\\adminvue\\src\\components\\Photo\\photoupdate.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\biyesheji\\AdminView\\adminvue\\src\\components\\Photo\\photoupdate.vue","mtime":1607243654095},{"path":"D:\\biyesheji\\AdminView\\adminvue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\biyesheji\\AdminView\\adminvue\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\biyesheji\\AdminView\\adminvue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\biyesheji\\AdminView\\adminvue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5leGVjIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLml0ZXJhdG9yIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnJlcGxhY2UiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLml0ZXJhdG9yIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLnVybCI7Ci8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCmltcG9ydCAnY3JvcHBlcmpzL2Rpc3QvY3JvcHBlci5jc3MnOwppbXBvcnQgeyB1cGxvYWRGaWxlUmVxdWVzdCB9IGZyb20gJ0AvdXRpbC9yZXF1ZXN0bmV0d29yay91cGxvYWRGaWxlUmVxdWVzdCc7CmltcG9ydCB7IHVwZGF0ZVBob3RvQnlJZCB9IGZyb20gJ0AvdXRpbC9yZXF1ZXN0bmV0d29yay9hZG1pbnJlcXVlc3QnOwppbXBvcnQgeyBnZXRQaG90b0J5SWQgfSBmcm9tICJAL3V0aWwvcmVxdWVzdG5ldHdvcmsvYWRtaW5yZXF1ZXN0IjsKaW1wb3J0IENyb3BwZXIgZnJvbSAnY3JvcHBlcmpzJzsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJwaG90b3VwZGF0ZSIsCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGRpYWxvZ1Zpc2libGU6IGZhbHNlLAogICAgICBwcmVpbWc6ICIiLAogICAgICBjcm9wcGVyOiBudWxsLAogICAgICBwaG90bzoge30KICAgIH07CiAgfSwKICBtZXRob2RzOiB7CiAgICBzaG93ZHJhZzogZnVuY3Rpb24gc2hvd2RyYWcoKSB7CiAgICAgIHRoaXMuZGlhbG9nVmlzaWJsZSA9IHRydWU7CiAgICAgIHZhciBmaWxlID0gdGhpcy4kcmVmcy5maWxlOwogICAgICB0aGlzLnByZWltZyA9IHdpbmRvdy5VUkwuY3JlYXRlT2JqZWN0VVJMKGZpbGUuZmlsZXNbMF0pOwogICAgICB0aGlzLiRyZWZzLmZpbGUudmFsdWUgPSAnJzsKICAgIH0sCiAgICBzaG93b3BlbmQ6IGZ1bmN0aW9uIHNob3dvcGVuZCgpIHsKICAgICAgaWYgKHRoaXMuY3JvcHBlciAhPSBudWxsKSB7CiAgICAgICAgdGhpcy5jcm9wcGVyLnJlcGxhY2UodGhpcy5wcmVpbWcpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIGltZ2cgPSB0aGlzLiRyZWZzLnRhcmltZzsKICAgICAgdGhpcy5jcm9wcGVyID0gbmV3IENyb3BwZXIoaW1nZywgewogICAgICAgIGFzcGVjdFJhdGlvOiAyLAogICAgICAgIHZpZXdNb2RlOiAxLAogICAgICAgIGRyYWdNb2RlOiAibm9uZSIsCiAgICAgICAgY3JvcEJveFJlc2l6YWJsZTogdHJ1ZSwKICAgICAgICBjcm9wQm94TW92YWJsZTogdHJ1ZQogICAgICB9KTsKICAgIH0sCiAgICBjb21taXRwaG90bzogZnVuY3Rpb24gY29tbWl0cGhvdG8oKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvLyB0aGlzLmRpYWxvZ1Zpc2libGU9ZmFsc2U7CiAgICAgIHRoaXMuY3JvcHBlci5nZXRDcm9wcGVkQ2FudmFzKCkudG9CbG9iKGZ1bmN0aW9uIChmaWxlKSB7CiAgICAgICAgLy8g6L+Z6YeM5LiK5Lyg55qE5pe25YCZ5Zug5Li65rKh5pyJ5ZCN5a2XLOaJgOS7peaJi+WKqOeahOa3u+WKoOaWh+S7tueahOWQjeWtlwogICAgICAgIHZhciBmaWxlbmFtZSA9IE1hdGgucmFuZG9tKCkgKyAiLnBuZyI7CiAgICAgICAgdmFyIGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKCk7CiAgICAgICAgZm9ybURhdGEuYXBwZW5kKCJpbWciLCBmaWxlLCBmaWxlbmFtZSk7CiAgICAgICAgdXBsb2FkRmlsZVJlcXVlc3QoZm9ybURhdGEpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgdmFyIHJlc3VsdGltZyA9IHJlcy5kYXRhLmRhdGE7CiAgICAgICAgICBfdGhpcy5waG90by5pbWd1cmwgPSByZXN1bHRpbWc7CiAgICAgICAgICB2YXIgaW1nID0ge307CiAgICAgICAgICBpbWcuaW1ndXJsID0gX3RoaXMucGhvdG8uaW1ndXJsOwogICAgICAgICAgaW1nLmlkID0gX3RoaXMucGhvdG8uaWQ7CiAgICAgICAgICBjb25zb2xlLmxvZygiKysrKysrKyIpOwogICAgICAgICAgY29uc29sZS5sb2codXBkYXRlUGhvdG9CeUlkKTsKICAgICAgICAgIHVwZGF0ZVBob3RvQnlJZChKU09OLnN0cmluZ2lmeShpbWcpKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgICAgX3RoaXMuZGlhbG9nVmlzaWJsZSA9IGZhbHNlOwogICAgICAgICAgICBjb25zb2xlLmxvZyhyZXMpOwogICAgICAgICAgICBjb25zb2xlLmxvZygiKysrKysrKysrKysrKysiKTsKCiAgICAgICAgICAgIF90aGlzLiRtZXNzYWdlKHsKICAgICAgICAgICAgICBtZXNzYWdlOiAn5oGt5Zac5L2g77yM5L+u5pS55oiQ5YqfJywKICAgICAgICAgICAgICB0eXBlOiAnc3VjY2VzcycKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHt9KTsKICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHt9KTsKICAgICAgfSk7CiAgICB9CiAgfSwKICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgdmFyIHBob3RvID0ge307CiAgICBwaG90by5pZCA9IHRoaXMuJHJvdXRlLnBhcmFtc1sicGhvdG9pZCJdOwogICAgZ2V0UGhvdG9CeUlkKEpTT04uc3RyaW5naWZ5KHBob3RvKSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgIF90aGlzMi5waG90byA9IHJlcy5kYXRhLmRhdGE7CiAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHt9KTsKICB9Cn07"},{"version":3,"sources":["photoupdate.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n\t<div class=\"photoupdate\">\r\n\t\t<el-dialog\r\n\t\ttitle=\"提示\"\r\n\t\t:visible.sync=\"dialogVisible\"\r\n\t\twidth=\"30%\"\r\n\t\t@opened=\"showopend\"\r\n\t\t>\r\n\t\t\t<div>\r\n\t\t\t\t<img :src=\"preimg\" alt=\"\" style=\"display: block;max-width: 100%;\" ref=\"tarimg\">\r\n\t\t\t</div>\r\n\t\t\t<span slot=\"footer\" class=\"dialog-footer\">\r\n\t\t\t<el-button @click=\"dialogVisible = false\">取 消</el-button>\r\n\t\t\t<el-button type=\"primary\" @click=\"commitphoto\">确 定</el-button>\r\n\t\t\t</span>\r\n\t\t</el-dialog>\r\n\t\t\r\n\t\t<el-card class=\"box-card\">\r\n\t\t\t<div slot=\"header\" class=\"clearfix\">\r\n\t\t\t\t<el-breadcrumb separator-class=\"el-icon-arrow-right\">\r\n\t\t\t\t\t<el-breadcrumb-item :to=\"{ path: '/admin/photoadmin' }\">超级管理员界面</el-breadcrumb-item>\r\n\t\t\t\t\t<el-breadcrumb-item>图片修改</el-breadcrumb-item>\r\n\t\t\t\t</el-breadcrumb>\r\n\t\t\t</div>\r\n\t\t\t<div>\r\n\t\t\t\t<el-card class=\"box-card\">\r\n\t\t\t\t\t<img :src=\"photo.imgurl\" alt=\"\">\r\n\t\t\t\t</el-card>\r\n\t\t\t\t<input type=\"file\" hidden=\"hidden\" id=\"file\" @change=\"showdrag\" ref=\"file\">\r\n\t\t\t\t<el-button type=\"primary\" style=\"margin-top: 10px;\"><label for=\"file\">点击修改</label></el-button>\r\n\t\t\t</div>\r\n\t\t</el-card>\r\n\t</div>\n</template>\n\n<script>\r\n\timport 'cropperjs/dist/cropper.css';\r\n\timport {uploadFileRequest} from '@/util/requestnetwork/uploadFileRequest'\r\n\timport {updatePhotoById} from '@/util/requestnetwork/adminrequest'\r\n\t\r\n\timport {getPhotoById} from \"@/util/requestnetwork/adminrequest\"\r\n\t\r\n\timport Cropper from 'cropperjs';\r\n\texport default{\r\n\t\tname:\"photoupdate\",\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tdialogVisible: false,\r\n\t\t\t\tpreimg:\"\",\r\n\t\t\t\tcropper:null,\r\n\t\t\t\tphoto:{}\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tshowdrag() {\r\n\t\t\t\tthis.dialogVisible=true;\r\n\t\t\t\tconst file=this.$refs.file;\r\n\t\t\t\tthis.preimg=window.URL.createObjectURL(file.files[0]);\r\n\t\t\t\tthis.$refs.file.value=''\r\n\t\t\t},\r\n\t\t\tshowopend(){\r\n\t\t\t\tif(this.cropper!=null){\r\n\t\t\t\t\tthis.cropper.replace(this.preimg);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tconst imgg=this.$refs.tarimg;\r\n\t\t\t\tthis.cropper=new Cropper(imgg,{\r\n\t\t\t\t\taspectRatio: 2,\r\n\t\t\t\t\tviewMode:1,\r\n\t\t\t\t\tdragMode: \"none\",\r\n\t\t\t\t\tcropBoxResizable:true,\r\n\t\t\t\t\tcropBoxMovable:true\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tcommitphoto(){\r\n\t\t\t\t// this.dialogVisible=false;\r\n\r\n\t\t\tthis.cropper.getCroppedCanvas().toBlob((file) => {\r\n\r\n// 这里上传的时候因为没有名字,所以手动的添加文件的名字\r\n\r\n\t\t\tlet filename=Math.random()+\".png\";\r\n\r\n\t\t\tconst formData = new FormData();\r\n\r\n\t\t\tformData.append(\"img\",file,filename);\r\n\r\n\t\t\tuploadFileRequest(formData).then(res=>{\r\n\r\n\t\t\tlet resultimg=res.data.data;\r\n\t\t\tthis.photo.imgurl=resultimg;\r\n\t\t\tlet img={};\r\n\t\t\timg.imgurl=this.photo.imgurl;\r\n\t\t\timg.id=this.photo.id;\r\n\t\t\tconsole.log(\"+++++++\")\r\n\t\t\tconsole.log(updatePhotoById)\r\n\t\t\tupdatePhotoById(JSON.stringify(img)).then(res=>{\r\n\t\t\t\tthis.dialogVisible=false;\r\n\t\t\t\tconsole.log(res);\r\n\t\t\t\tconsole.log(\"++++++++++++++\")\r\n\t\t\t\t this.$message({\r\n\t\t\t\tmessage: '恭喜你，修改成功',\r\n\t\t\t\ttype: 'success'\r\n\t\t\t\t});\r\n\t\t\t}).catch(error=>{\r\n\t\t\t\t\r\n\t\t\t})\r\n\t\t\t}).catch(error=>{\r\n\r\n\t\t\t})\r\n\t\t\t})}\r\n\t\t\t},\r\n\t\t\tcreated(){\r\n\t\t\t\tlet photo={};\r\n\t\t\t\tphoto.id=this.$route.params[\"photoid\"];\r\n\t\t\t\tgetPhotoById(JSON.stringify(photo)).then(res=>{\r\n\t\t\t\t\tthis.photo=res.data.data;\r\n\t\t\t\t}).catch(error=>{\r\n\t\t\t\t\t\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\n</script>\n\n<style>\n</style>\n"],"sourceRoot":"src/components/Photo"}]}