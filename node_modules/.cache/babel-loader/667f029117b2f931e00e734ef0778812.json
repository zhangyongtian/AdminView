{"remainingRequest":"D:\\biyesheji\\AdminView\\adminvue\\node_modules\\babel-loader\\lib\\index.js!D:\\biyesheji\\AdminView\\adminvue\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\biyesheji\\AdminView\\adminvue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\biyesheji\\AdminView\\adminvue\\src\\components\\Useradmin\\setUserRole.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\biyesheji\\AdminView\\adminvue\\src\\components\\Useradmin\\setUserRole.vue","mtime":1609481277864},{"path":"D:\\biyesheji\\AdminView\\adminvue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\biyesheji\\AdminView\\adminvue\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\biyesheji\\AdminView\\adminvue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\biyesheji\\AdminView\\adminvue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5kZXgtb2YiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAiOwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwppbXBvcnQgeyBnZXRVc2VyQnlJZCB9IGZyb20gJ0AvdXRpbC9yZXF1ZXN0bmV0d29yay91c2VyQWRtaW5SZXF1ZXN0JzsKaW1wb3J0IHsgZ2V0QWxsUm9sZSB9IGZyb20gJ0AvdXRpbC9yZXF1ZXN0bmV0d29yay91c2VyQWRtaW5SZXF1ZXN0JzsKaW1wb3J0IHsgdXBkYXRlVXNlclJvbGVzIH0gZnJvbSAnQC91dGlsL3JlcXVlc3RuZXR3b3JrL3VzZXJBZG1pblJlcXVlc3QnOwppbXBvcnQgeyBnZXRVc2VyQWxsUm9sZSB9IGZyb20gJ0AvdXRpbC9yZXF1ZXN0bmV0d29yay91c2VyQWRtaW5SZXF1ZXN0JzsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICIiLAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICB1c2VySWQ6IC0xLAogICAgICB1c2VyOiB7fSwKICAgICAgYWxsUm9sZTogW10sCiAgICAgIHVzZXJIYXNSb2xlSWQ6IFtdLAogICAgICB1c2VyTm90SGF2ZVJvbGVSb2xlOiBbXQogICAgfTsKICB9LAogIGNyZWF0ZWQ6IGZ1bmN0aW9uIGNyZWF0ZWQoKSB7CiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIHRoaXMudXNlcklkID0gdGhpcy4kcm91dGUucGFyYW1zWyJ1c2VySWQiXTsKICAgIHZhciB1c2VyID0ge307CiAgICB1c2VyLmlkID0gdGhpcy51c2VySWQ7CiAgICBnZXRVc2VyQnlJZChKU09OLnN0cmluZ2lmeSh1c2VyKSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgIF90aGlzLnVzZXIgPSByZXMuZGF0YS5kYXRhOyAvLyDkuIvpnaLmmK/ojrflj5bmiYDmnInnmoTop5LoibIKCiAgICAgIGdldFVzZXJBbGxSb2xlKCkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgLy/kuIvpnaLmmK/miYDmnInnmoTop5LoibIKICAgICAgICB2YXIgZGF0YSA9IHJlcy5kYXRhLmRhdGE7CiAgICAgICAgY29uc29sZS5sb2cocmVzKTsKICAgICAgICBfdGhpcy5hbGxSb2xlID0gZGF0YTsKICAgICAgICBfdGhpcy51c2VySGFzUm9sZUlkID0gX3RoaXMudXNlci5yb2xlcy5tYXAoZnVuY3Rpb24gKHJvbGUpIHsKICAgICAgICAgIHJldHVybiByb2xlLnJvbGVpZDsKICAgICAgICB9KTsKICAgICAgICBfdGhpcy51c2VyTm90SGF2ZVJvbGVSb2xlID0gX3RoaXMuYWxsUm9sZS5maWx0ZXIoZnVuY3Rpb24gKHJvbGUpIHsKICAgICAgICAgIHJldHVybiBfdGhpcy51c2VySGFzUm9sZUlkLmluZGV4T2Yocm9sZS5yb2xlaWQpIDwgMDsKICAgICAgICB9KTsKICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7fSk7CiAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHt9KTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGRlbGV0ZVJvbGU6IGZ1bmN0aW9uIGRlbGV0ZVJvbGUoaXRlbSkgewogICAgICB0aGlzLmRlbGV0ZVNlbGZSb2xlKHRoaXMudXNlci5yb2xlcywgaXRlbSk7CiAgICAgIHRoaXMudXNlck5vdEhhdmVSb2xlUm9sZS5wdXNoKGl0ZW0pOwogICAgfSwKICAgIGFkZFJvbGU6IGZ1bmN0aW9uIGFkZFJvbGUoaXRlbSkgewogICAgICB0aGlzLmRlbGV0ZVNlbGZSb2xlKHRoaXMudXNlck5vdEhhdmVSb2xlUm9sZSwgaXRlbSk7CiAgICAgIHRoaXMudXNlci5yb2xlcy5wdXNoKGl0ZW0pOwogICAgfSwKICAgIC8v5LiL6Z2i5bCx5piv5o+Q5L6b6Ieq5bexaXRlbeWwseaYr+WcqOS4gOS4quiHquW3seeahGl0ZW1BcnJheemHjOmdouWIoOmZpOiHquW3sQogICAgZGVsZXRlU2VsZlJvbGU6IGZ1bmN0aW9uIGRlbGV0ZVNlbGZSb2xlKGl0ZW1BcnJheSwgaXRlbSkgewogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGl0ZW1BcnJheS5sZW5ndGg7IGkrKykgewogICAgICAgIGlmIChpdGVtQXJyYXlbaV0ucm9sZWlkID09IGl0ZW0ucm9sZWlkKSB7CiAgICAgICAgICBpZiAoaSA9PSBpdGVtQXJyYXkubGVuZ3RoIC0gMSkgewogICAgICAgICAgICBpdGVtQXJyYXkucG9wKCk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGZvciAodmFyIGogPSBpOyBqIDwgaXRlbUFycmF5Lmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgaXRlbUFycmF5W2pdID0gaXRlbUFycmF5W2ogKyAxXTsKICAgICAgICAgICAgICBjb25zb2xlLmxvZyhpdGVtQXJyYXkpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpdGVtQXJyYXkucG9wKCk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBjb21taXRSb2xlczogZnVuY3Rpb24gY29tbWl0Um9sZXMoKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgY29uc29sZS5sb2coIuaPkOS6pCIpOwogICAgICB2YXIgdXNlciA9IHt9OwogICAgICB1c2VyLmlkID0gdGhpcy51c2VyLmlkOwogICAgICB1c2VyLnJvbGVzID0gdGhpcy51c2VyLnJvbGVzOwogICAgICB1cGRhdGVVc2VyUm9sZXMoSlNPTi5zdHJpbmdpZnkodXNlcikpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgIGNvbnNvbGUubG9nKHJlcyk7CgogICAgICAgIF90aGlzMi4kbWVzc2FnZSh7CiAgICAgICAgICBtZXNzYWdlOiAn5oGt5Zac5L2g77yM5L+u5pS56KeS6Imy5oiQ5YqfJywKICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJwogICAgICAgIH0pOwogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHt9KTsKICAgIH0KICB9Cn07"},{"version":3,"sources":["setUserRole.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n\t<div>\r\n\t\t<el-card class=\"box-card\">\r\n\t\t\t<div slot=\"header\" class=\"clearfix\">\r\n\t\t\t\t<el-breadcrumb separator-class=\"el-icon-arrow-right\">\r\n\t\t\t\t\t<el-breadcrumb-item :to=\"{ path: `/admin/setUserRole/${userId}` }\">超级管理员界面</el-breadcrumb-item>\r\n\t\t\t\t\t<el-breadcrumb-item>用户权限管理</el-breadcrumb-item>\r\n\t\t\t\t</el-breadcrumb>\r\n\t\t\t</div>\r\n\t\t\t<div>\r\n\t\t\t\t<el-card class=\"box-card\">\r\n\t\t\t\t\t点击角色执行删除添加角色\r\n\t\t\t\t</el-card>\r\n\t\t\t</div>\r\n\t\t\t<!-- 这里是 用户的显示部分 -->\r\n\t\t\t<div style=\"margin-top: 10px;\">\r\n\t\t\t\t<el-card class=\"box-card\">\r\n\t\t\t\t\t<div slot=\"header\" class=\"clearfix\">\r\n\t\t\t\t\t\t<span>用户已有角色</span>\t\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<template>\r\n\t\t\t\t\t\t\t<template v-for=\"(item,index) in user.roles\">\r\n\t\t\t\t\t\t\t\t<el-tag style=\"margin-left: 7px;\" @click=\"deleteRole(item)\">{{item.rolename}}</el-tag>\r\n\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</el-card>\r\n\t\t\t</div>\r\n\t\t\t<!-- 下面是设置权限 -->\r\n\t\t\t<div style=\"margin-top: 10px;\">\r\n\t\t\t\t<el-card class=\"box-card\">\r\n\t\t\t\t\t<div slot=\"header\" class=\"clearfix\">\r\n\t\t\t\t\t\t<span>下面是可以设置的角色</span>\t\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<template>\r\n\t\t\t\t\t\t\t<template v-for=\"(item,index) in userNotHaveRoleRole\">\r\n\t\t\t\t\t\t\t\t<el-tag style=\"margin-left: 7px;\"  @click=\"addRole(item)\">{{item.rolename}}</el-tag>\r\n\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</el-card>\r\n\t\t\t</div>\r\n\t\t\t<div style=\"margin-top: 10px;\">\r\n\t\t\t\t<el-card class=\"box-card\">\r\n\t\t\t\t\t<el-button type=\"success\" round @click=\"commitRoles\">确认角色分配</el-button>\r\n\t\t\t\t</el-card>\r\n\t\t\t</div>\r\n\t\t</el-card>\r\n\t</div>\n</template>\n\n<script>\r\n\timport {getUserById} from '@/util/requestnetwork/userAdminRequest'\r\n\timport {getAllRole} from '@/util/requestnetwork/userAdminRequest'\r\n\timport {updateUserRoles} from '@/util/requestnetwork/userAdminRequest'\r\n\timport {getUserAllRole} from '@/util/requestnetwork/userAdminRequest'\r\n\t\r\n\t\r\n\t\r\n\texport default{\r\n\t\tname:\"\",\r\n\t\tdata(){\r\n\t\t\treturn{\r\n\t\t\t\tuserId:-1,\r\n\t\t\t\tuser:{},\r\n\t\t\t\tallRole:[],\r\n\t\t\t\tuserHasRoleId:[],\r\n\t\t\t\tuserNotHaveRoleRole:[]\r\n\t\t\t}\r\n\t\t},\r\n\t\tcreated() {\r\n\t\t\tthis.userId=this.$route.params[\"userId\"];\r\n\t\t\t\r\n\t\t\tlet user={};\r\n\t\t\tuser.id=this.userId;\r\n\t\t\tgetUserById(JSON.stringify(user)).then(res=>{\r\n\t\t\t\tthis.user=res.data.data;\r\n\t\t\t\t\r\n\t\t\t\t// 下面是获取所有的角色\r\n\t\t\t\tgetUserAllRole().then(res=>{\r\n\t\t\t\t\t//下面是所有的角色\r\n\t\t\t\t\tlet data=res.data.data;\r\n\t\t\t\t\tconsole.log(res)\r\n\t\t\t\t\tthis.allRole=data;\r\n\t\t\t\t\tthis.userHasRoleId=this.user.roles.map(role=>{\r\n\t\t\t\t\t\treturn role.roleid\r\n\t\t\t\t\t})\r\n\t\t\t\t\tthis.userNotHaveRoleRole=this.allRole.filter(role=>{\r\n\t\t\t\t\t\treturn this.userHasRoleId.indexOf(role.roleid)<0;\r\n\t\t\t\t\t})\r\n\t\t\t\t}).catch(error=>{\r\n\t\t\t\t\t\r\n\t\t\t\t})\r\n\t\t\t}).catch(error=>{\r\n\t\t\t\t\r\n\t\t\t})\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t},\r\n\t\tmethods:{\r\n\t\t\tdeleteRole(item){\r\n\t\t\t\tthis.deleteSelfRole(this.user.roles,item);\r\n\t\t\t\tthis.userNotHaveRoleRole.push(item);\r\n\t\t\t},\r\n\t\t\taddRole(item){\r\n\t\t\t\tthis.deleteSelfRole(this.userNotHaveRoleRole,item);\r\n\t\t\t\tthis.user.roles.push(item)\r\n\t\t\t},\r\n\t\t\t//下面就是提供自己item就是在一个自己的itemArray里面删除自己\r\n\t\t\tdeleteSelfRole(itemArray,item){\r\n\t\t\t\tfor(let i=0;i<itemArray.length;i++){\r\n\t\t\t\t\tif(itemArray[i].roleid==item.roleid){\r\n\t\t\t\t\t\tif(i==itemArray.length-1){\r\n\t\t\t\t\t\t\titemArray.pop();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tfor(let j=i;j<itemArray.length;j++){\r\n\t\t\t\t\t\t\t\titemArray[j]=itemArray[j+1];\r\n\t\t\t\t\t\t\t\tconsole.log(itemArray)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\titemArray.pop();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t},\r\n\t\t\tcommitRoles(){\r\n\t\t\t\tconsole.log(\"提交\")\r\n\t\t\t\tlet user={};\r\n\t\t\t\tuser.id=this.user.id;\r\n\t\t\t\tuser.roles=this.user.roles;\r\n\t\t\t\tupdateUserRoles(JSON.stringify(user)).then(res=>{\r\n\t\t\t\t\tconsole.log(res)\r\n\t\t\t\t\tthis.$message({\r\n\t\t\t\t\tmessage: '恭喜你，修改角色成功',\r\n\t\t\t\t\ttype: 'success'\r\n\t\t\t\t});\r\n\t\t\t\t}).catch(error=>{\r\n\t\t\t\t\t\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t}\n</script>\n\n<style>\n</style>\n"],"sourceRoot":"src/components/Useradmin"}]}