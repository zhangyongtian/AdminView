{"remainingRequest":"D:\\biyesheji\\AdminView\\adminvue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\biyesheji\\AdminView\\adminvue\\src\\components\\Useradmin\\setUserRole.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\biyesheji\\AdminView\\adminvue\\src\\components\\Useradmin\\setUserRole.vue","mtime":1609481473709},{"path":"D:\\biyesheji\\AdminView\\adminvue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\biyesheji\\AdminView\\adminvue\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\biyesheji\\AdminView\\adminvue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\biyesheji\\AdminView\\adminvue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7Z2V0VXNlckJ5SWR9IGZyb20gJ0AvdXRpbC9yZXF1ZXN0bmV0d29yay91c2VyQWRtaW5SZXF1ZXN0JwppbXBvcnQge2dldEFsbFJvbGV9IGZyb20gJ0AvdXRpbC9yZXF1ZXN0bmV0d29yay91c2VyQWRtaW5SZXF1ZXN0JwppbXBvcnQge3VwZGF0ZVVzZXJSb2xlc30gZnJvbSAnQC91dGlsL3JlcXVlc3RuZXR3b3JrL3VzZXJBZG1pblJlcXVlc3QnCmltcG9ydCB7Z2V0VXNlckFsbFJvbGV9IGZyb20gJ0AvdXRpbC9yZXF1ZXN0bmV0d29yay91c2VyQWRtaW5SZXF1ZXN0JwoKCgpleHBvcnQgZGVmYXVsdHsKCW5hbWU6IiIsCglkYXRhKCl7CgkJcmV0dXJuewoJCQl1c2VySWQ6LTEsCgkJCXVzZXI6e30sCgkJCWFsbFJvbGU6W10sCgkJCXVzZXJIYXNSb2xlSWQ6W10sCgkJCXVzZXJOb3RIYXZlUm9sZVJvbGU6W10KCQl9Cgl9LAoJY3JlYXRlZCgpIHsKCQl0aGlzLnVzZXJJZD10aGlzLiRyb3V0ZS5wYXJhbXNbInVzZXJJZCJdOwoJCQoJCWxldCB1c2VyPXt9OwoJCXVzZXIuaWQ9dGhpcy51c2VySWQ7CgkJZ2V0VXNlckJ5SWQoSlNPTi5zdHJpbmdpZnkodXNlcikpLnRoZW4ocmVzPT57CgkJCXRoaXMudXNlcj1yZXMuZGF0YS5kYXRhOwoJCQkKCQkJLy8g5LiL6Z2i5piv6I635Y+W5omA5pyJ55qE6KeS6ImyCgkJCWdldFVzZXJBbGxSb2xlKEpTT04uc3RyaW5naWZ5KHVzZXIpKS50aGVuKHJlcz0+ewoJCQkJLy/kuIvpnaLmmK/miYDmnInnmoTop5LoibIKCQkJCWxldCBkYXRhPXJlcy5kYXRhLmRhdGE7CgkJCQljb25zb2xlLmxvZyhyZXMpCgkJCQl0aGlzLmFsbFJvbGU9ZGF0YTsKCQkJCXRoaXMudXNlckhhc1JvbGVJZD10aGlzLnVzZXIucm9sZXMubWFwKHJvbGU9PnsKCQkJCQlyZXR1cm4gcm9sZS5yb2xlaWQKCQkJCX0pCgkJCQljb25zb2xlLmxvZygi5LiL6Z2i5piv6I635Y+W5omA5pyJ55qE6KeS6ImyIikKCQkJCWdldEFsbFJvbGUoKS50aGVuKHJlcz0+ewoJCQkJCWNvbnNvbGUubG9nKHJlcykKCQkJCX0pCgkJCQl0aGlzLnVzZXJOb3RIYXZlUm9sZVJvbGU9dGhpcy5hbGxSb2xlLmZpbHRlcihyb2xlPT57CgkJCQkJcmV0dXJuIHRoaXMudXNlckhhc1JvbGVJZC5pbmRleE9mKHJvbGUucm9sZWlkKTwwOwoJCQkJfSkKCQkJfSkuY2F0Y2goZXJyb3I9PnsKCQkJCQoJCQl9KQoJCX0pLmNhdGNoKGVycm9yPT57CgkJCQoJCX0pCgkJCgkJCgkJCgkJCgl9LAoJbWV0aG9kczp7CgkJZGVsZXRlUm9sZShpdGVtKXsKCQkJdGhpcy5kZWxldGVTZWxmUm9sZSh0aGlzLnVzZXIucm9sZXMsaXRlbSk7CgkJCXRoaXMudXNlck5vdEhhdmVSb2xlUm9sZS5wdXNoKGl0ZW0pOwoJCX0sCgkJYWRkUm9sZShpdGVtKXsKCQkJdGhpcy5kZWxldGVTZWxmUm9sZSh0aGlzLnVzZXJOb3RIYXZlUm9sZVJvbGUsaXRlbSk7CgkJCXRoaXMudXNlci5yb2xlcy5wdXNoKGl0ZW0pCgkJfSwKCQkvL+S4i+mdouWwseaYr+aPkOS+m+iHquW3sWl0ZW3lsLHmmK/lnKjkuIDkuKroh6rlt7HnmoRpdGVtQXJyYXnph4zpnaLliKDpmaToh6rlt7EKCQlkZWxldGVTZWxmUm9sZShpdGVtQXJyYXksaXRlbSl7CgkJCWZvcihsZXQgaT0wO2k8aXRlbUFycmF5Lmxlbmd0aDtpKyspewoJCQkJaWYoaXRlbUFycmF5W2ldLnJvbGVpZD09aXRlbS5yb2xlaWQpewoJCQkJCWlmKGk9PWl0ZW1BcnJheS5sZW5ndGgtMSl7CgkJCQkJCWl0ZW1BcnJheS5wb3AoKTsKCQkJCQkJcmV0dXJuOwoJCQkJCX1lbHNlewoJCQkJCQkKCQkJCQkJZm9yKGxldCBqPWk7ajxpdGVtQXJyYXkubGVuZ3RoO2orKyl7CgkJCQkJCQlpdGVtQXJyYXlbal09aXRlbUFycmF5W2orMV07CgkJCQkJCQljb25zb2xlLmxvZyhpdGVtQXJyYXkpCgkJCQkJCX0KCQkJCQkJaXRlbUFycmF5LnBvcCgpOwoJCQkJCQlyZXR1cm47CgkJCQkJCQoJCQkJCX0KCQkJCX0KCQkJfQoJCQkKCQl9LAoJCWNvbW1pdFJvbGVzKCl7CgkJCWNvbnNvbGUubG9nKCLmj5DkuqQiKQoJCQlsZXQgdXNlcj17fTsKCQkJdXNlci5pZD10aGlzLnVzZXIuaWQ7CgkJCXVzZXIucm9sZXM9dGhpcy51c2VyLnJvbGVzOwoJCQl1cGRhdGVVc2VyUm9sZXMoSlNPTi5zdHJpbmdpZnkodXNlcikpLnRoZW4ocmVzPT57CgkJCQljb25zb2xlLmxvZyhyZXMpCgkJCQl0aGlzLiRtZXNzYWdlKHsKCQkJCW1lc3NhZ2U6ICfmga3llpzkvaDvvIzkv67mlLnop5LoibLmiJDlip8nLAoJCQkJdHlwZTogJ3N1Y2Nlc3MnCgkJCX0pOwoJCQl9KS5jYXRjaChlcnJvcj0+ewoJCQkJCgkJCX0pCgkJfQoJfQp9Cg=="},{"version":3,"sources":["setUserRole.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsDA;AACA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;;;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"setUserRole.vue","sourceRoot":"src/components/Useradmin","sourcesContent":["<template>\r\n\t<div>\r\n\t\t<el-card class=\"box-card\">\r\n\t\t\t<div slot=\"header\" class=\"clearfix\">\r\n\t\t\t\t<el-breadcrumb separator-class=\"el-icon-arrow-right\">\r\n\t\t\t\t\t<el-breadcrumb-item :to=\"{ path: `/admin/setUserRole/${userId}` }\">超级管理员界面</el-breadcrumb-item>\r\n\t\t\t\t\t<el-breadcrumb-item>用户权限管理</el-breadcrumb-item>\r\n\t\t\t\t</el-breadcrumb>\r\n\t\t\t</div>\r\n\t\t\t<div>\r\n\t\t\t\t<el-card class=\"box-card\">\r\n\t\t\t\t\t点击角色执行删除添加角色\r\n\t\t\t\t</el-card>\r\n\t\t\t</div>\r\n\t\t\t<!-- 这里是 用户的显示部分 -->\r\n\t\t\t<div style=\"margin-top: 10px;\">\r\n\t\t\t\t<el-card class=\"box-card\">\r\n\t\t\t\t\t<div slot=\"header\" class=\"clearfix\">\r\n\t\t\t\t\t\t<span>用户已有角色</span>\t\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<template>\r\n\t\t\t\t\t\t\t<template v-for=\"(item,index) in user.roles\">\r\n\t\t\t\t\t\t\t\t<el-tag style=\"margin-left: 7px;\" @click=\"deleteRole(item)\">{{item.rolename}}</el-tag>\r\n\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</el-card>\r\n\t\t\t</div>\r\n\t\t\t<!-- 下面是设置权限 -->\r\n\t\t\t<div style=\"margin-top: 10px;\">\r\n\t\t\t\t<el-card class=\"box-card\">\r\n\t\t\t\t\t<div slot=\"header\" class=\"clearfix\">\r\n\t\t\t\t\t\t<span>下面是可以设置的角色</span>\t\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<template>\r\n\t\t\t\t\t\t\t<template v-for=\"(item,index) in userNotHaveRoleRole\">\r\n\t\t\t\t\t\t\t\t<el-tag style=\"margin-left: 7px;\"  @click=\"addRole(item)\">{{item.rolename}}</el-tag>\r\n\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</el-card>\r\n\t\t\t</div>\r\n\t\t\t<div style=\"margin-top: 10px;\">\r\n\t\t\t\t<el-card class=\"box-card\">\r\n\t\t\t\t\t<el-button type=\"success\" round @click=\"commitRoles\">确认角色分配</el-button>\r\n\t\t\t\t</el-card>\r\n\t\t\t</div>\r\n\t\t</el-card>\r\n\t</div>\n</template>\n\n<script>\r\n\timport {getUserById} from '@/util/requestnetwork/userAdminRequest'\r\n\timport {getAllRole} from '@/util/requestnetwork/userAdminRequest'\r\n\timport {updateUserRoles} from '@/util/requestnetwork/userAdminRequest'\r\n\timport {getUserAllRole} from '@/util/requestnetwork/userAdminRequest'\r\n\t\r\n\t\r\n\t\r\n\texport default{\r\n\t\tname:\"\",\r\n\t\tdata(){\r\n\t\t\treturn{\r\n\t\t\t\tuserId:-1,\r\n\t\t\t\tuser:{},\r\n\t\t\t\tallRole:[],\r\n\t\t\t\tuserHasRoleId:[],\r\n\t\t\t\tuserNotHaveRoleRole:[]\r\n\t\t\t}\r\n\t\t},\r\n\t\tcreated() {\r\n\t\t\tthis.userId=this.$route.params[\"userId\"];\r\n\t\t\t\r\n\t\t\tlet user={};\r\n\t\t\tuser.id=this.userId;\r\n\t\t\tgetUserById(JSON.stringify(user)).then(res=>{\r\n\t\t\t\tthis.user=res.data.data;\r\n\t\t\t\t\r\n\t\t\t\t// 下面是获取所有的角色\r\n\t\t\t\tgetUserAllRole(JSON.stringify(user)).then(res=>{\r\n\t\t\t\t\t//下面是所有的角色\r\n\t\t\t\t\tlet data=res.data.data;\r\n\t\t\t\t\tconsole.log(res)\r\n\t\t\t\t\tthis.allRole=data;\r\n\t\t\t\t\tthis.userHasRoleId=this.user.roles.map(role=>{\r\n\t\t\t\t\t\treturn role.roleid\r\n\t\t\t\t\t})\r\n\t\t\t\t\tconsole.log(\"下面是获取所有的角色\")\r\n\t\t\t\t\tgetAllRole().then(res=>{\r\n\t\t\t\t\t\tconsole.log(res)\r\n\t\t\t\t\t})\r\n\t\t\t\t\tthis.userNotHaveRoleRole=this.allRole.filter(role=>{\r\n\t\t\t\t\t\treturn this.userHasRoleId.indexOf(role.roleid)<0;\r\n\t\t\t\t\t})\r\n\t\t\t\t}).catch(error=>{\r\n\t\t\t\t\t\r\n\t\t\t\t})\r\n\t\t\t}).catch(error=>{\r\n\t\t\t\t\r\n\t\t\t})\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t},\r\n\t\tmethods:{\r\n\t\t\tdeleteRole(item){\r\n\t\t\t\tthis.deleteSelfRole(this.user.roles,item);\r\n\t\t\t\tthis.userNotHaveRoleRole.push(item);\r\n\t\t\t},\r\n\t\t\taddRole(item){\r\n\t\t\t\tthis.deleteSelfRole(this.userNotHaveRoleRole,item);\r\n\t\t\t\tthis.user.roles.push(item)\r\n\t\t\t},\r\n\t\t\t//下面就是提供自己item就是在一个自己的itemArray里面删除自己\r\n\t\t\tdeleteSelfRole(itemArray,item){\r\n\t\t\t\tfor(let i=0;i<itemArray.length;i++){\r\n\t\t\t\t\tif(itemArray[i].roleid==item.roleid){\r\n\t\t\t\t\t\tif(i==itemArray.length-1){\r\n\t\t\t\t\t\t\titemArray.pop();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tfor(let j=i;j<itemArray.length;j++){\r\n\t\t\t\t\t\t\t\titemArray[j]=itemArray[j+1];\r\n\t\t\t\t\t\t\t\tconsole.log(itemArray)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\titemArray.pop();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t},\r\n\t\t\tcommitRoles(){\r\n\t\t\t\tconsole.log(\"提交\")\r\n\t\t\t\tlet user={};\r\n\t\t\t\tuser.id=this.user.id;\r\n\t\t\t\tuser.roles=this.user.roles;\r\n\t\t\t\tupdateUserRoles(JSON.stringify(user)).then(res=>{\r\n\t\t\t\t\tconsole.log(res)\r\n\t\t\t\t\tthis.$message({\r\n\t\t\t\t\tmessage: '恭喜你，修改角色成功',\r\n\t\t\t\t\ttype: 'success'\r\n\t\t\t\t});\r\n\t\t\t\t}).catch(error=>{\r\n\t\t\t\t\t\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t}\n</script>\n\n<style>\n</style>\n"]}]}